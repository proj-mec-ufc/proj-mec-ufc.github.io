<html>
<head>
    <script src="../jquery-3.6.0.js"></script>

    <link href="https://unpkg.com/tabulator-tables/dist/css/tabulator.min.css" rel="stylesheet">
    <script type="text/javascript" src="https://unpkg.com/tabulator-tables/dist/js/tabulator.min.js"></script>
    <link rel="stylesheet" type="text/css" href=".././dist/dynamic_table.css" />
</head>

<body>
    <div id="dt1" class="dynamic_table"></div>
</body>

<script>
    // ----- Values passed to the dynamic table

    let tableData = [
        {Número:"235", Milhar:"", Centena: "", Dezena: "", Unidade: ""},
        {Número:"1647", Milhar:"", Centena: "", Dezena: "", Unidade: ""},
        {Número:"81", Milhar:"", Centena: "", Dezena: "", Unidade: ""},
    ];

    let cols = [
        {field:"Número"},
        {field:"Milhar",  editor:"input" },
        {field:"Centena", editor:"input" },
        {field:"Dezena",  editor:"input" },
        {field:"Unidade", editor:"input" },
    ];

    let correctValues = [
        {Número:"235", Milhar:"0", Centena: "2", Dezena: "3", Unidade: "5"},
        {Número:"1647", Milhar:"1", Centena: "6", Dezena: "4", Unidade: "7"},
        {Número:"81", Milhar:"0", Centena: "0", Dezena: "8", Unidade: "1"},
    ];

    // -------------------------------------------

    function getLine(value) {
        for(var i=0; i<correctValues.length; i++) 
            if(correctValues[i].Número==value) // ****** automate
                return i
        return -1;
    };

    $( document ).ready(function() {
        for (let i=0; i<cols.length; i++){
            cols[i]["title"] = cols[i]["field"];
            cols[i]["sorter"] = "string";
        }

        var table = new Tabulator("#dt1", {
            data: tableData,
            layout:"fitColumns",
            columns: cols,
            ajaxConfig: {
                method:"post",
                headers: {
                    "Content-type": 'application/json; charset=utf-8',
                },
            },
        });

        table.on("cellEdited", function(cell){ 
            let col = cell.getColumn();
            let row = cell.getRow();
            let field = col.getField();
            let digitedValue = row.getData()[field];
            let rowNumber = getLine(row.getData()['Número']); // ****** automate
            let correctValue;

            // review to automate
            switch (field) {
            case 'Unidade':
                correctValue = correctValues[rowNumber].Unidade;
                break;
            case 'Dezena':
                correctValue = correctValues[rowNumber].Dezena;
                break;
            case 'Centena':
                correctValue = correctValues[rowNumber].Centena;
                break;
            case 'Milhar':
                correctValue = correctValues[rowNumber].Milhar;
                break;
            }
            
            if (correctValue==digitedValue){
                cell.getElement().style.backgroundColor = "#00ddff";
            }
            else {
                if ((correctValue=='')&&(digitedValue=='0')){
                    cell.getElement().style.backgroundColor = "#00ddff";
                }
                else
                    cell.getElement().style.backgroundColor = "";
            }
        });
    });

</script>

</html>